<!DOCTYPE html>
<html lang="en-us">
    <head>
      <meta charset="utf-8">
      <title> LCDs and Buttons | Embedded Systems Design </title>  <!-- mobile responsive meta -->
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="Embedded Systems Design Blog">
  <meta name="author" content="ESD Faculty">
  <meta name="generator" content="Hugo 0.127.0">

  <!-- plugins -->
  
  <link rel="stylesheet" href="https://embedded-systems-design.github.io/plugins/bootstrap/bootstrap.min.css ">
  
  <link rel="stylesheet" href="https://embedded-systems-design.github.io/plugins/slick/slick.css ">
  
  <link rel="stylesheet" href="https://embedded-systems-design.github.io/plugins/themify-icons/themify-icons.css ">
  
  <link rel="stylesheet" href="https://embedded-systems-design.github.io/plugins/venobox/venobox.css ">
  
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.5.0/font/bootstrap-icons.css ">
  

  <!-- Main Stylesheet -->
  
  <link rel="stylesheet" href="https://embedded-systems-design.github.io/scss/style.min.css" media="screen">

  <!--Favicon-->
  <link rel="shortcut icon" href="https://embedded-systems-design.github.io/images/favicon.png " type="image/x-icon">
  <link rel="icon" href="https://embedded-systems-design.github.io/images/favicon.png " type="image/x-icon">

  <!-- google analitycs -->
  <script>
    (function (i, s, o, g, r, a, m) {
      i['GoogleAnalyticsObject'] = r;
      i[r] = i[r] || function () {
        (i[r].q = i[r].q || []).push(arguments)
      }, i[r].l = 1 * new Date();
      a = s.createElement(o),
        m = s.getElementsByTagName(o)[0];
      a.async = 1;
      a.src = g;
      m.parentNode.insertBefore(a, m)
    })(window, document, 'script', '//www.google-analytics.com/analytics.js', 'ga');
    ga('create', '', 'auto');
    ga('send', 'pageview');
  </script>
<script>
  MathJax = {
    tex: {
      inlineMath: [['$', '$'], ['\\(', '\\)']],
      displayMath: [['$$','$$'], ['\\[', '\\]']],
      processEscapes: true,
      processEnvironments: true
    },
    options: {
      skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre']
    }
  };

  window.addEventListener('load', (event) => {
      document.querySelectorAll("mjx-container").forEach(function(x){
        x.parentElement.classList += 'has-jax'})
    });

</script>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script type="text/javascript" id="MathJax-script" async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

    </head>

    <body>
<!-- preloader start -->
<div class="preloader">
  
</div>
<!-- preloader end -->
<!-- navigation -->
<header class="navigation">
  <div class="container">
    
    <nav class="navbar navbar-expand-lg navbar-white bg-transparent border-bottom pl-0">
      <a class="navbar-brand mobile-view" href="https://embedded-systems-design.github.io/"><img class="img-fluid"
          src="https://embedded-systems-design.github.io/images/esd6.png" alt="Embedded Systems Design"></a>
      <button class="navbar-toggler border-0" type="button" data-toggle="collapse" data-target="#navigation">
        <i class="ti-menu"></i>
      </button>

      <div class="collapse navbar-collapse text-center" id="navigation">
        <div class="desktop-view">
          <ul class="navbar-nav mr-auto">
            
            <li class="nav-item">
              <a class="nav-link" href="https://github.com/embedded-systems-design"><i class="ti-github"></i></a>
            </li>
            
          </ul>
        </div>

        <a class="navbar-brand mx-auto desktop-view" href="https://embedded-systems-design.github.io/"><img class="img-fluid"
            src="https://embedded-systems-design.github.io/images/esd6.png" alt="Embedded Systems Design"></a>

        <ul class="navbar-nav">
          
          
          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" href="#" role="button" data-toggle="dropdown" aria-haspopup="true"
              aria-expanded="false">
              Cadence
            </a>
            <div class="dropdown-menu">
              
              <a class="dropdown-item" href="https://embedded-systems-design.github.io/cadence/">All Cadence Posts</a>
              
              <a class="dropdown-item" href="https://embedded-systems-design.github.io/cadence/getting-started/">Getting Started</a>
              
              <a class="dropdown-item" href="https://embedded-systems-design.github.io/cadence/schematics/">Schematics</a>
              
              <a class="dropdown-item" href="https://embedded-systems-design.github.io/cadence/schematics-to-pcbs/">Cadence Schematics to PCB</a>
              
              <a class="dropdown-item" href="https://embedded-systems-design.github.io/cadence/designing-pcbs/">Designing PCBs</a>
              
              <a class="dropdown-item" href="https://embedded-systems-design.github.io/cadence/manufacturing-pcbs/">Manufacturing PCBs</a>
              
            </div>
          </li>
          
          
          
          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" href="#" role="button" data-toggle="dropdown" aria-haspopup="true"
              aria-expanded="false">
              KiCad
            </a>
            <div class="dropdown-menu">
              
              <a class="dropdown-item" href="https://embedded-systems-design.github.io/kicad/">All KiCad Posts</a>
              
              <a class="dropdown-item" href="https://embedded-systems-design.github.io/kicad-installation-and-setup/">Install and Setup</a>
              
              <a class="dropdown-item" href="https://embedded-systems-design.github.io/kicad/kicad-schematic-design/">Schematic Design Pages</a>
              
              <a class="dropdown-item" href="https://embedded-systems-design.github.io/kicad/kicad-pcb-design/">KiCad PCB Design Pages</a>
              
              <a class="dropdown-item" href="https://embedded-systems-design.github.io/packaging-kicad-files-for-submission/">Packaging Files</a>
              
            </div>
          </li>
          
          
          
          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" href="#" role="button" data-toggle="dropdown" aria-haspopup="true"
              aria-expanded="false">
              Altium
            </a>
            <div class="dropdown-menu">
              
              <a class="dropdown-item" href="https://embedded-systems-design.github.io/altium/">All Altium Posts</a>
              
              <a class="dropdown-item" href="https://embedded-systems-design.github.io/altium/altium-documentation-links/">Transferring Schematics to PCB</a>
              
            </div>
          </li>
          
          
          
          <li class="nav-item">
            <a class="nav-link" href="https://embedded-systems-design.github.io/parts/">Parts</a>
          </li>
          
          
          
          <li class="nav-item">
            <a class="nav-link" href="https://embedded-systems-design.github.io/misc/">Misc</a>
          </li>
          
          
          
          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" href="#" role="button" data-toggle="dropdown" aria-haspopup="true"
              aria-expanded="false">
              Tutorials
            </a>
            <div class="dropdown-menu">
              
              <a class="dropdown-item" href="https://embedded-systems-design.github.io/tutorials/">All Tutorials</a>
              
              <a class="dropdown-item" href="https://embedded-systems-design.github.io/tutorials/circuit-design/">Circuit Design</a>
              
              <a class="dropdown-item" href="https://embedded-systems-design.github.io/tutorials/esp32/">ESP32</a>
              
              <a class="dropdown-item" href="https://embedded-systems-design.github.io/tutorials/pic/">PIC</a>
              
              <a class="dropdown-item" href="https://embedded-systems-design.github.io/tutorials/psoc/">PSoC</a>
              
            </div>
          </li>
          
          
        </ul>

        
        <!-- search -->
        <form action="https://embedded-systems-design.github.io//search" class="d-flex">
        <input class="form-control me-2"  id="search-query"  name="s" type="s" placeholder="Search" aria-label="Search">
        <button class="btn btn-outline-success"  type="submit"><i class="ti-search text-dark"></i></button>
      </form>



        

        
      </div>
    </nav>
  </div>
</header>
<!-- /navigation -->


<section class="section-sm">
  <div class="container">



      <div class="row">
      <div class="col-lg-8 mx-auto">

      <div class="text-center">
<nav aria-label="breadcrumb">
  <ol class="breadcrumb">
  







<li class="breadcrumb-item"><a href="https://embedded-systems-design.github.io/">Welcome</a></li>


<li class="breadcrumb-item"><a href="https://embedded-systems-design.github.io/tutorials/">Tutorials</a></li>


<li class="breadcrumb-item"><a href="https://embedded-systems-design.github.io/tutorials/pic/">PIC</a></li>


<li class="breadcrumb-item active"><a href="https://embedded-systems-design.github.io/pic-lcd-button/">LCDs and Buttons</a></li>

</ol>
</nav>
</div>






        <h2>LCDs and Buttons</h2>
        
        <div class="mb-1 post-meta">
          <span>By ESD Faculty</span>
          
          
          
        </div>
        <ul class="list-inline">
          
        </ul>
        
        <div class="content mb-5">
          <p><em><strong>Individual Assignment</strong></em></p>
<h2 id="objectives">Objectives</h2>
<p>To develop and demonstrate individual proficiency in:</p>
<ol>
<li>
<p>Reading multiple buttons with a microcontroller and controlling an output</p>
</li>
<li>
<p>Displaying text on a character LCD screen</p>
</li>
<li>
<p>Updating a character LCD screen based on input from multiple buttons</p>
</li>
</ol>
<p><strong>This is an individual homework assignment. While you may talk with others about how to complete the assignment, you must individually design, write, and implement all code and circuitry by yourself. All cases of academic dishonesty (including sharing your or using others&rsquo; code, circuits, or breadboards) will be reported to the Dean&rsquo;s office.</strong></p>
<h2 id="resources">Resources</h2>
<ul>
<li>
<p><a href="https://ww1.microchip.com/downloads/en/DeviceDoc/PIC18F27-47Q10-Data-Sheet-40002043E.pdf"><em>PIC18F47Q10 Datasheet</em></a></p>
</li>
<li>
<p><a href="https://www.microchip.com/Developmenttools/ProductDetails/DM182029"><em>PIC18F47Q10 Curiosity Nano</em></a> Microchip Main Page</p>
<ul>
<li>
<p><a href="https://ww1.microchip.com/downloads/en/DeviceDoc/PIC18F47Q10-Curiosity-Nano-Hardware-User-Guide-40002103B.pdf"><em>Hardware User Guide</em></a></p>
</li>
<li>
<p><a href="https://ww1.microchip.com/downloads/en/DeviceDoc/PIC18F47Q10-CNANO_Design_Documentation_Rev5.zip"><em>Design Documentation</em></a></p>
</li>
<li>
<p><a href="https://ww1.microchip.com/downloads/en/DeviceDoc/PIC18F47Q10-CNANO_Schematics.pdf"><em>Schematic</em></a></p>
</li>
<li>
<p><a href="http://ww1.microchip.com/downloads/en/Appnotes/Getting-Started-with-UART-Using-EUSART-on-PIC18-90003282A.pdf"><em>Microchip tutorial &amp; example</em></a></p>
</li>
</ul>
</li>
<li>
<p>LCD</p>
<ul>
<li>
<p><a href="https://www.dropbox.com/s/62i7214y63ljucp/eone-1602a1.pdf?dl=0"><em>1602A datasheet</em></a></p>
</li>
<li>
<p><a href="https://www.dropbox.com/s/bs90okyqkg6x926/pic-lcd-library-master.zip?dl=0"><em>pic-lcd-library-master.zip</em></a> (note that this code has been tweaked slightly from what is posted on Github)</p>
</li>
<li>
<p><a href="https://github.com/ideras/pic-lcd-library/blob/master/README.md"><em>README for pic-lcd-library-master</em></a></p>
</li>
</ul>
</li>
<li>
<p>Scherz, P., &amp; Monk, S. (2016). <a href="https://www.amazon.com/Practical-Electronics-Inventors-Fourth-Scherz/dp/1259587541/ref=sr_1_1?s=books&amp;ie=UTF8&amp;qid=1470699914&amp;sr=1-1&amp;keywords=practical+electronics+for+inventors+4th+edition"><em>Practical electronics for inventors, fourth edition.</em></a> New York: McGraw Hill. ISBN: 978-1259587542</p>
</li>
<li>
<p>Canvas Discussion Board</p>
</li>
</ul>
<h2 id="prior-to-demonstration-of-proficiency">Prior to Demonstration of Proficiency</h2>
<p><em>Complete all of the steps below prior to the demonstration of proficiency.</em></p>
<h3 id="10-breadboard-preparations">1.0 Breadboard Preparations</h3>
<p>In this assignment, you may use either the <a href="https://www.microchip.com/Developmenttools/ProductDetails/DM182029"><em>PIC18F47Q10 Curiosity Nano</em></a> or the PIC18F47Q10 DIP IC connected to your breadboard.</p>
<p>The components necessary for this assignment will take up most of the space on your breadboard. To minimize time spent rewiring, it is recommended that you lay out the large components prior to wiring to ensure sufficient space.</p>
<h2 id="components">Components</h2>
<table>
<thead>
<tr>
<th>Part</th>
</tr>
</thead>
<tbody>
<tr>
<td>PIC18F47Q10 Curiosity Nano (or DIP IC)</td>
</tr>
<tr>
<td><a href="https://www.amazon.com/uxcell-1602A-5V-Display-Screen-Module/dp/B01M0CTXCN/">16x2 LCD screen</a> (You will need to solder on a 16-pin male to male header in order to connect it to the breadboard.)</td>
</tr>
<tr>
<td>75Ω resistor.</td>
</tr>
<tr>
<td>One breadboard-compatible 10kOhm potentiometer</td>
</tr>
<tr>
<td>Two breadboard-compatible SPST buttons</td>
</tr>
<tr>
<td>LED and an appropriate current-limiting resistor (or the onboard LED)</td>
</tr>
</tbody>
</table>
<p>Arrange all of the above components on your breadboard so that you will be able to connect wires to each of them.</p>
<p><em>Hint: Place the Curiosity Nano board as far to one edge of the breadboard as possible such that the micro USB port is accessible from the edge of the board, and place the LCD screen adjacent to the opposite of the board. This will leave you with space for the potentiometer, buttons, and LED.</em></p>
<h3 id="20-reading-multiple-buttons-and-controlling-an-led">2.0 Reading Multiple Buttons and Controlling an LED</h3>
<ol>
<li>Study the following critical information and concepts:</li>
</ol>
<table>
<thead>
<tr>
<th><strong>Critical Information and Concepts</strong></th>
<th><strong>Importance</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>a.  How each of the 4 pins of the button in your kit are wired.</td>
<td>Needed to correctly wire the button into your circuit. Use your DMM set to continuity mode and test all combinations of the pins being connected with the button pressed and not pressed.</td>
</tr>
<tr>
<td>b.  What a pullup resistor is, why it is necessary, and how you can enable an onboard pullup in the PIC.</td>
<td>Needed to understand how to properly wire the switch so that it is always providing a value to the PIC. First, read section 12.6.9 of <a href="https://www.amazon.com/Practical-Electronics-Inventors-Fourth-Scherz/dp/1259587541"><em>Scherz &amp; Monk</em></a>.</td>
</tr>
<tr>
<td>c.  In the Microchip MPLab Code Configurator <a href="https://www.microchip.com/mymicrochip/filehandler.aspx?ddocname=en1001463"><em>User&rsquo;s Guide</em></a>, determine what WPU and OD stand for. WPU is explained better on <a href="https://microchipdeveloper.com/mcc:mccgpio"><em>this page that discusses setting up GPIO</em></a>. Look up the explanation for OD by searching for &ldquo;ODC Registers&rdquo; on <a href="https://microchipdeveloper.com/16bit:io-ports"><em>this page</em></a> to understand its use for a different PIC family.</td>
<td>Determine the correct GPIO settings for I/O pins, as well as the best way to use these options in conjunction with a pushbutton switch.</td>
</tr>
</tbody>
</table>
<ol start="2">
<li>
<p>Wire the two buttons on your breadboard to two different I/O pins. Avoid Port D pins (these will be used for the LCD later). Wire the other side of each button to ground. With this configuration the I/O pin will be grounded when the button is pressed, and floating (no specific voltage) when the button is not pressed. This will cause problems with reading the button when it is not pressed, but this issue can be fixed in software later.</p>
</li>
<li>
<p>Wire the external LED and appropriate current-limiting resistor to another I/O pin. Avoid Port D pins.</p>
</li>
<li>
<p>Launch MPLAB® X and create a new project for your PIC IC.</p>
</li>
<li>
<p>Open Microchip Code Configurator and apply the following settings:</p>
<blockquote>
<p>Please use <strong>MCC Classic</strong>.  We can support it better, it has more advanced configuration options, but is also still relatively easy to use.</p>
</blockquote>
<ol>
<li>
<p>System</p>
<ol>
<li>
<p>System Clock: Configure your system clock to use the HFINTOSC at 4MHz</p>
</li>
<li>
<p>Clock divider: select a clock divider of 4.</p>
</li>
<li>
<p>Disable watchdog timer (unused)</p>
</li>
<li>
<p>Disable low-freq programming</p>
</li>
</ol>
</li>
<li>
<p>In the Pin Manager, make sure that the Package matches the package of the PIC you are using. Then, in the Pin Manager configure GPIO pins for the two buttons.</p>
</li>
<li>
<p>In the Pin Module, configure the PICs internal pull-up resistors to both button pins. This will ensure that the pins&rsquo; inputs are not floating when the buttons are not pressed (grounded).</p>
</li>
<li>
<p>Add a PWM with 50% duty cycle and associated Timer. Configure the timer in a similar way to how you did in HW2. Then, in the Pin Manager connect the output of the PWM to the LED pin.</p>
</li>
<li>
<p>Add a UART component as you did in HW1 for debugging purposes <em>(optional)</em></p>
</li>
</ol>
</li>
<li>
<p>Write code to do the following:</p>
<ol>
<li>
<p>Initialize the PWM duty cycle to 50% of its maximum value.</p>
<blockquote>
<p>(See pwmX.h for the API function to do this)</p>
</blockquote>
</li>
<li>
<p>Read the current value of each button.</p>
<blockquote>
<p>(See pin_manager.h for the API function to do this)</p>
</blockquote>
</li>
<li>
<p>If the left button is pressed, decrease the current duty cycle by 25% of the total PWM resolution</p>
</li>
<li>
<p>If the right button is pressed, increase the duty cycle of the PWM by 25% of the total PWM resolution</p>
</li>
<li>
<p>If no button is pressed, do not change the duty cycle.</p>
</li>
<li>
<p>Wait for 200 ms before repeating steps c - f.</p>
<blockquote>
<p><em>Note: This delay reduces the likelihood of a single button press causing a fast change in the duty cycle. A better way to do this is by processing button presses using interrupts, which you will do later in the semester in another homework assignment.</em></p>
</blockquote>
</li>
</ol>
</li>
<li>
<p>Compile and download your code to the microcontroller. The code should visibly change the duty cycle of the blinking LED up or down depending on which button is pushed.</p>
</li>
</ol>
<blockquote>
<p><em>If this step doesn&rsquo;t work, debug by first checking all connections against the data sheet, looking for error messages in the IDE, and searching for the error messages on Google. Next, try adding a UART component and printing the value of the duty cycle variable to see if it changes. If you&rsquo;re still stuck, see the teaching team for help.</em></p>
</blockquote>
<h3 id="30-displaying-information-on-a-character-lcd-screen">3.0 Displaying information on a character LCD screen</h3>
<ol>
<li>Study the following critical information and concepts:</li>
</ol>
<table>
<thead>
<tr>
<th><strong>Critical Information and Concepts</strong></th>
<th><strong>Importance</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>a.  How dot-matrix LCDs work and are controlled.</td>
<td>Needed to understand the hardware and software necessary to get the LCD communicating with your microcontroller. First, read section 12.10.2 of <a href="https://www.amazon.com/Practical-Electronics-Inventors-Fourth-Scherz/dp/1259587541"><em>Scherz &amp; Monk</em></a> starting from the subsection on <em>&ldquo;Intelligent&rdquo; Dot-Matrix LCD Modules</em>. This section describes a module that is very similar to the one you will be using.</td>
</tr>
<tr>
<td>b.  What the purpose of each pin on your LCD module is, and which pins should be connected to a microcontroller if the LCD is in 4-bit mode.</td>
<td>Needed to understand the specific connections of the LCD module in your EGR 304 kit, which is a 16x2 character LCD (model number 1602A). Study the entire <a href="https://www.openhacks.com/uploadsproductos/eone-1602a1.pdf"><em>1602A datasheet</em></a> to understand the hardware and software interfaces. Note that the controller chip on this LCD uses the same protocol as the common Hitachi HD44780-based LCDs. Also note that this datasheet (as well as those for most other similar LCDs) are not very good, with inconsistent and unclear information.</td>
</tr>
<tr>
<td>c.  How the LCD code library works, and what API (application programming interface) functions it provides.</td>
<td>Needed in order to program your LCD to display text. The functions are specific to this library, so you will need to study the .h and .c files as well as the <a href="https://github.com/ideras/pic-lcd-library/blob/master/README.md"><em>README</em> <em>file</em></a> for pic-lcd-library-master.</td>
</tr>
<tr>
<td>d.  In this <a href="https://www.tutorialspoint.com/c_standard_library/c_function_sprintf.htm"><em>tutorial on sprintf()</em></a>, determine what library(or libraries) you need to include</td>
<td>You will need to format a string.</td>
</tr>
</tbody>
</table>
<ol start="2">
<li>Wire the LCD as follows:</li>
</ol>
<table>
<thead>
<tr>
<th style="text-align:left"><strong>LCD Pin</strong></th>
<th style="text-align:left"><strong>PIC18F47Q10 Pin</strong></th>
<th style="text-align:left"><strong>Comments</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">VSS</td>
<td style="text-align:left">TBD</td>
<td style="text-align:left">Follow the connection diagram on page 4 in the <a href="https://www.openhacks.com/uploadsproductos/eone-1602a1.pdf"><em>1602A datasheet</em></a>. Use your 3.3V supply for power to your LCD.</td>
</tr>
<tr>
<td style="text-align:left">VDD</td>
<td style="text-align:left">TBD</td>
<td style="text-align:left"></td>
</tr>
<tr>
<td style="text-align:left">V0</td>
<td style="text-align:left">TBD</td>
<td style="text-align:left"></td>
</tr>
<tr>
<td style="text-align:left">RS</td>
<td style="text-align:left">Any unused pin in Port D except RD0-3</td>
<td style="text-align:left">It is more organized if the control pins are on the same port as the data pins.</td>
</tr>
<tr>
<td style="text-align:left">RW</td>
<td style="text-align:left">Ground</td>
<td style="text-align:left">You will configure the LCD driver library to control the LCD in 4-bit mode, and this pin is not used in 4-bit mode.</td>
</tr>
<tr>
<td style="text-align:left">E</td>
<td style="text-align:left">Any unused pin in Port D except RD0-3</td>
<td style="text-align:left">It is more organized if the control pins are on the same port as the data pins.</td>
</tr>
<tr>
<td style="text-align:left">D0</td>
<td style="text-align:left">Ground</td>
<td style="text-align:left">You will configure the LCD driver library to control the LCD in 4-bit mode, so these pins should not be connected (see section 12.10.2 of <a href="https://www.amazon.com/Practical-Electronics-Inventors-Fourth-Scherz/dp/1259587541"><em>Scherz &amp; Monk</em></a>).</td>
</tr>
<tr>
<td style="text-align:left">D1</td>
<td style="text-align:left">Ground</td>
<td style="text-align:left"></td>
</tr>
<tr>
<td style="text-align:left">D2</td>
<td style="text-align:left">Ground</td>
<td style="text-align:left"></td>
</tr>
<tr>
<td style="text-align:left">D3</td>
<td style="text-align:left">Ground</td>
<td style="text-align:left"></td>
</tr>
<tr>
<td style="text-align:left">D4</td>
<td style="text-align:left">RD0</td>
<td style="text-align:left">The LCD driver library you will be using requires that the four pins start at the lowest nibble (4 bits) of a PIC port.</td>
</tr>
<tr>
<td style="text-align:left">D5</td>
<td style="text-align:left">RD1</td>
<td style="text-align:left"></td>
</tr>
<tr>
<td style="text-align:left">D6</td>
<td style="text-align:left">RD2</td>
<td style="text-align:left"></td>
</tr>
<tr>
<td style="text-align:left">D7</td>
<td style="text-align:left">RD3</td>
<td style="text-align:left"></td>
</tr>
<tr>
<td style="text-align:left">A</td>
<td style="text-align:left">3.3V through 75Ω resistor</td>
<td style="text-align:left">This is the power pin for the backlight. Connect it to 3.3V through a 75Ω current-limiting resistor. Note that we are using a +3.3V power supply instead of +5V per the Absolute Maximum table in the datasheet.</td>
</tr>
<tr>
<td style="text-align:left">K</td>
<td style="text-align:left">Ground</td>
<td style="text-align:left">This is the ground pin for the backlight.</td>
</tr>
</tbody>
</table>
<ol start="3">
<li>
<p>Launch MPLAB® X and load your project from part 2.0 of this assignment. In MPLAB® X, right-click on the project name and select &ldquo;Copy&rdquo; from the contextual menu to make a copy that will include both the button and the LCD. Then, right-click on the new project and select &ldquo;Set as main project&rdquo; from the contextual menu.</p>
<p>a.  In Windows, copy the .h and .c files from the <a href="https://www.dropbox.com/s/bs90okyqkg6x926/pic-lcd-library-master.zip?dl=0"><em>pic-lcd-library-master.zip</em></a> file to the same folder as your MPLAB® X project files for this assignment (at the same folder level as main.c).</p>
<p>b.  In MPLAB® X, right-click on the Header Files and Source Files folders and select &ldquo;Add Existing Item&hellip;&rdquo; to add the .h and .c files from the PIC LCD Library to their respective folders in your project.</p>
<p>c.  Modify the project hardware to add output pins that match those you selected and connected above. Make sure that none of the pins are set as analog. It is helpful to rename the pins in the Pin Module according to their purpose in the project.
&gt; <em>Note: If you added a UART to Port D you will have to remove it so that it doesn&rsquo;t conflict with the LCD.</em></p>
</li>
<li>
<p>Modify your existing code in main.c to add the following features:</p>
</li>
</ol>
<blockquote>
<p>The next step involves referencing and modifying some example code given by the original developer of the library. <em><strong>You will need to read, modify, and fix</strong></em> this code in order to get it working and <em>customize</em> it according to the specific pins you are using.</p>
</blockquote>
<p></p>
<blockquote>
<p><em>Context:</em> Finding code online is often fraught with problems. This can include incomplete documentation, outright errors, and code that is not written specifically for your device.</p>
</blockquote>
<p>a.  Include the LCD.h header file so that you can use the LCD library functions in main.c.</p>
<p>b.  Configure and initialize the LCD screen according to the example in the <a href="https://github.com/ideras/pic-lcd-library/blob/master/README.md"><em>README</em> <em>file</em></a> for pic-lcd-library-master. Pay special attention to ensure you are specifying the correct pins for &ldquo;register select&rdquo; and &ldquo;reset&rdquo; pins</p>
<p>c.  Based on the <a href="https://github.com/ideras/pic-lcd-library/blob/master/README.md"><em>README</em> <em>file example code</em></a> and the functions in LCD.h, add code to display your name and anything else you would like to write on the LCD.</p>
<ol start="5">
<li>
<p>Compile and download your code to the microcontroller. The code should display the text you specified on the LCD screen. If it doesn&rsquo;t work, here are some debugging steps:</p>
<p>a.  Like much code downloaded from the Internet, there are errors in the <a href="https://github.com/ideras/pic-lcd-library/blob/master/README.md"><em>README</em> <em>file example code</em></a>. Refer to the error messages from the compiler when debugging as well as the function definitions in LCD.h.</p>
<p>b.  The potentiometer is to adjust the contrast of the screen. If you don&rsquo;t see any text, try adjusting the potentiometer.</p>
<p>c.  If you still don&rsquo;t see anything on the screen, double-check your wiring.</p>
<p>d.  If your wiring is correct, double-check that the code (particularly the LCD initialization function) matches your wiring configuration.</p>
<p>e.  If your code is correct, try unplugging and re-plugging the USB cable into the Curiosity Nano. This causes the chip and the LCD screen to reset.</p>
<p>f.  If you&rsquo;re still stuck, see the teaching team for help.</p>
</li>
</ol>
<h3 id="40-displaying-the-current-duty-cycle-on-the-lcd-screen">4.0 Displaying the current duty cycle on the LCD screen</h3>
<ol>
<li>Study the following critical information and concepts:</li>
</ol>
<table>
<thead>
<tr>
<th><strong>Critical Information and Concepts</strong></th>
<th><strong>Importance</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>a.  How to convert a 16-bit unsigned integer into a character string</td>
<td>Needed in order to print the duty cycle variable to the LCD screen as an integer. Study the functions in the <a href="https://www.tutorialspoint.com/c_standard_library/stdio_h.htm"><em>stdio.h library</em></a> to find one that is appropriate for this purpose.</td>
</tr>
</tbody>
</table>
<ol start="2">
<li>
<p>Launch MPLAB® X and load your project from part 3.0 of this assignment. In MPLAB® X, right-click on the project name and select &ldquo;Copy&rdquo; from the contextual menu to make a copy that will include both the button and the LCD. Then, right-click on the new project and select &ldquo;Set as main project&rdquo; from the contextual menu.</p>
</li>
<li>
<p>Modify your existing code in main.c to add the following features:</p>
<p>a.  Include the library for sprintf()</p>
<p>b.  Configure and initialize the LCD screen.</p>
<p>c.  On the first line of the LCD screen, display text with your initials and &ldquo;Duty Cycle&rdquo;.</p>
<p>d.  On the second line of the LCD screen, display the current value of the duty cycle register as an integer.</p>
<p>e.  Read the current value of each button.</p>
<p>f.  If the left button is pressed, decrease the current duty cycle by 25% of the total PWM resolution and update the duty cycle number on the LCD screen</p>
<p>g.  If the right button is pressed, increase the duty cycle of the PWM by 25% of the total PWM resolution and update the duty cycle number on the LCD screen</p>
<p>h.  If no button is pressed, do not change the duty cycle or what is displayed on the LCD screen.</p>
<p>i.  Wait for 200 ms before repeating steps 3 - h.</p>
</li>
<li>
<p>Compile and download your code to the microcontroller. The code should display your custom text label on the first line and the current integer value of the duty cycle variable on the second line. When you press the up button, the duty cycle value should increase on the LCD screen and the duty cycle of the LED flashing should increase by 25%. When you press the down button, the duty cycle value should decrease on the LCD screen and the duty cycle of the LED flashing should decrease by 25%.</p>
</li>
</ol>
<hr>
<h2 id="next">Next</h2>
<p>Check out the <a href="/timers-and-interrupts-lcd/">Timers and Interrupts Tutorial</a> that follows this!</p>
<!--

## Individual Demonstration of Proficiency

1.  Connect your Curiosity Nano to a computer via USB. Open MPLAB® X. Talk through your breadboard design and connections.

2.  Open your project for Part 2.0, compile, download, and demonstrate it visibly changing the duty cycle of the blinking LED up or down depending on which button is pushed.

3.  Open your project for Part 3.0, compile, download, and demonstrate it displaying your name and additional text on the LCD screen.

4.  Open your project for Part 4.0, compile, download, and demonstrate it displaying your initials and the current duty cycle as an integer on the LCD screen, in addition to flashing an external LED at the current duty cycle, and changing that duty cycle both on the LCD screen and the LED depending on which button is pushed. **If you demonstrate Part 4.0 fully then you do not need to demonstrate Parts 2 or 3.**

***NOTE: When you are done with this assignment, keep your system wired up for next week's assignment, which will (mostly) use the same breadboard layout***

## Canvas Submission

Submit your packaged MPLAB® X projects (right-click on the project and select "Package" from the contextual menu) for each section in ZIP format to this assignment on [*Canvas*](https://canvas.asu.edu) by the deadline in Canvas. *Do not submit links to Google documents.* It is your responsibility to ensure that your submission to Canvas was successful. Late Canvas submissions will be graded per the policy in the syllabus. No credit will be awarded for assignments not submitted to Canvas, even if a demonstration was completed.

## Grading

+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------+
| **Demonstration**                                                                                                                                                                                              | **Points** |
+================================================================================================================================================================================================================+============+
| 1.  Knowledge of your breadboard configuration and how to connect and download code to the PIC.                                                                                                                | 50         |
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------+
| 2.  Changing the LED duty cycle up or down based on button presses                                                                                                                                             | 75         |
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------+
| 3.  Displaying your name on the LCD screen                                                                                                                                                                     | 75         |
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------+
| 4.  Displaying your initials and the current duty cycle on the LCD while controlling the duty cycle of an external LED and the value on the LCD with button presses (checking this off counts for parts 2 + 3) | 100        |
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------+
| **Total**                                                                                                                                                                                                      | 300        |
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------+

-->
        </div>

        
        
      </div>
    </div>
  </div>
</section>



<footer class="text-capitalize">
  <div class="container">
    <div class="row justify-content-center">
      <div class="col-12 border-top py-4 text-center ">
      </div>
      
      <div class="col-lg-4 col-sm-6 mb-5 text-center">
        <h6 class="mb-4">Contact Me</h6>
        <ul class="list-unstyled">
          
          
          <li class="mb-3"><i class="ti-location-pin mr-3 text-primary"></i>Arizona State University</li>
          
          
          </li>
        </ul>
      </div>
      
      <div class="col-lg-4 col-sm-6 mb-5 text-center">
        <h6 class="mb-4">External</h6>
        <ul class="list-unstyled">
          
          <li class="mb-3"><a class="text-dark" href="https://github.com/embedded-systems-design">github</a></li>
          
        </ul>
      </div>
      <div class="col-lg-4 col-sm-6 mb-5 text-center">
        <h6 class="mb-4">Quick Links</h6>
        <ul class="list-unstyled">
          
          <li class="mb-3"><a class="text-dark" href="https://embedded-systems-design.github.io/about/">About</a></li>
          
          <li class="mb-3"><a class="text-dark" href="https://embedded-systems-design.github.io/contact/">Contact</a></li>
          
        </ul>
      </div>
      <div class="col-12 mb-5 text-center">
        <a href="https://embedded-systems-design.github.io/"><img src="https://embedded-systems-design.github.io/images/esd6.png" alt="Embedded Systems Design"></a>
      </div>

      <div class="col-12 mb-5 text-center">
        <p>|  copyright © 2022 Shawn Jordan and Dan Aukes.  All Rights Reserved.  |</p>
        
        
        
        
        

        
        
        <p><a href="https://github.com/embedded-systems-design/project_esd_website_source/edit/main/content/tutorials/pic/pic-lcd-button/index.md"> Edit this Page</a></p>
        
        
        
      </div>

    </div>
  </div>
</footer>

<script>
  var indexURL = "https://embedded-systems-design.github.io/index.json"
</script>

<!-- JS Plugins -->

<script src="https://embedded-systems-design.github.io/plugins/jQuery/jquery.min.js"></script>

<script src="https://embedded-systems-design.github.io/plugins/bootstrap/bootstrap.min.js"></script>

<script src="https://embedded-systems-design.github.io/plugins/slick/slick.min.js"></script>

<script src="https://embedded-systems-design.github.io/plugins/venobox/venobox.min.js"></script>

<script src="https://embedded-systems-design.github.io/plugins/search/fuse.min.js"></script>

<script src="https://embedded-systems-design.github.io/plugins/search/mark.js"></script>

<script src="https://embedded-systems-design.github.io/plugins/search/search.js"></script>

<!-- Main Script -->

<script src="https://embedded-systems-design.github.io/js/script.min.js"></script><script>

            var lightbox = GLightbox();
            lightbox.on('open', (target) => {
                console.log('lightbox opened');
            });
            var lightboxDescription = GLightbox({
                selector: '.glightbox2'
            });
            var lightboxVideo = GLightbox({
                selector: '.glightbox3'
            });
            lightboxVideo.on('slide_changed', ({ prev, current }) => {
                console.log('Prev slide', prev);
                console.log('Current slide', current);

                const { slideIndex, slideNode, slideConfig, player } = current;

                if (player) {
                    if (!player.ready) {
                        
                        player.on('ready', (event) => {
                            
                        });
                    }

                    player.on('play', (event) => {
                        console.log('Started play');
                    });

                    player.on('volumechange', (event) => {
                        console.log('Volume change');
                    });

                    player.on('ended', (event) => {
                        console.log('Video ended');
                    });
                }
            });

            var lightboxInlineIframe = GLightbox({
                selector: '.glightbox4'
            });

            

    

    

</script>


</body>
</html>
